create table Account_tbl(
 Account_Number varchar2(10) PRIMARY KEY, 
 Customer_Name varchar2(15),
 Balance  Number(10,2)
);
INSERT INTO Account_tbl(Account_Number,Customer_Name,Balance)
values('123456789','Reddy',80000);
values('344453455','Mahesh',0);
values('867564534','Dhanu',100);
values('756434243','Sam',500);

create table Transfer_tbl(
  Transaction_ID Number(4) PRIMARY KEY,
  Account_Number Varchar2(10) FOREIGN KEY REFERENCES Account_tbl (Account_Number) ,
  Beneficiary_account_number Varchar2(10) FOREIGN KEY REFERENCES Account_tbl (Account_Number),
  Traansaction_Date Date ,
  Transaction_Amount Number(10,2)
  );
  
  
  
  package com.wipro.bank.util;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class DBUtil {

    public static Connection getDBConnection() {
        Connection con = null;
        try {
            Class.forName("oracle.jdbc.driver.OracleDriver");
            con = DriverManager.getConnection(
                    "jdbc:oracle:thin:@localhost:1521:xe",
                    "username",
                    "password"
            );
        } catch (ClassNotFoundException | SQLException e) {
            e.printStackTrace();
        }
        return con;
    }
}





package com.wipro.bank.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.wipro.bank.util.DBUtil;

public class BankDAO {

    // Generate Transaction Sequence Number
    public int generateSequenceNumber() {
        int seq = 0;
        String sql = "SELECT TRANSACTION_SEQ.NEXTVAL FROM DUAL";

        try (Connection con = DBUtil.getDBConnection();
             PreparedStatement ps = con.prepareStatement(sql);
             ResultSet rs = ps.executeQuery()) {

            if (rs.next()) {
                seq = rs.getInt(1);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return seq;
    }

    // Validate Account Number
    public boolean validateAccount(String accountNumber) {
        boolean isValid = false;
        String sql = "SELECT 1 FROM ACCOUNT_TBL WHERE ACCOUNT_NUMBER = ?";

        try (Connection con = DBUtil.getDBConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setString(1, accountNumber);
            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                isValid = true;
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return isValid;
    }

    // Find Balance
    public float findBalance(String accountNumber) {
        float balance = -1;
        String sql = "SELECT BALANCE FROM ACCOUNT_TBL WHERE ACCOUNT_NUMBER = ?";

        try (Connection con = DBUtil.getDBConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setString(1, accountNumber);
            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                balance = rs.getFloat("BALANCE");
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return balance;
    }

    // Transfer Money
    public boolean transferMoney(String fromAcc, String toAcc, float amount) {
        boolean result = false;

        String debitSQL = "UPDATE ACCOUNT_TBL SET BALANCE = BALANCE - ? WHERE ACCOUNT_NUMBER = ?";
        String creditSQL = "UPDATE ACCOUNT_TBL SET BALANCE = BALANCE + ? WHERE ACCOUNT_NUMBER = ?";

        try (Connection con = DBUtil.getDBConnection()) {
            con.setAutoCommit(false);

            try (PreparedStatement ps1 = con.prepareStatement(debitSQL);
                 PreparedStatement ps2 = con.prepareStatement(creditSQL)) {

                ps1.setFloat(1, amount);
                ps1.setString(2, fromAcc);

                ps2.setFloat(1, amount);
                ps2.setString(2, toAcc);

                int d = ps1.executeUpdate();
                int c = ps2.executeUpdate();

                if (d == 1 && c == 1) {
                    con.commit();
                    result = true;
                } else {
                    con.rollback();
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return result;
    }
}



public float findBalance(String accountNumber) {
        Connection connection = DBUtil.getDBConnection();
        String query = "SELECT Balance FROM Account_TBL WHERE Account_Number = ?";
        float balance = -1;

        try {
            PreparedStatement ps = connection.prepareStatement(query);
            ps.setString(1, accountNumber);
            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                balance = rs.getFloat("Balance");
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return balance;
    }
}
  